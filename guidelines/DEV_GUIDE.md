# ACPaaS UI dev guide

## Table of Contents

1. [Available commands](#commands)
2. [Package vs Library](#packagevslibrary)
3. [Dependencies](dependencies)
4. [Styleguide](#styleguide)

---

## [Available commands](commands)

Since the ACPaaS UI library was created using the `angular-cli`, all the cli commands are available to use during development. You can use a global install (make sure to check the supported version in the root `package.json` file) or the local copy installed in the dev dependencies:

```bash
ng
```
or
```bash
npm run ng
```

Some useful commands:

* `ng lint`: run the linter on the entire library
* `ng lint <package>`: run the linter on a specific package
* `ng test`: run the unit tests for the entire library
* `ng test <package>`: run the unit tests for a specific package
* `npm run build`: build the entire library (see below)
* `ng build <package>`: build a specific package
* `npm run bump -- --major|minor|patch`: bump the library version
* `npm run deploy[:major|minor|patch]`: bump the library version and deploy a new build
* `npm run package <package>`: generate a new package

For now, only the library generation is used, custom schematics might be added in the future to make the generation of other components possible as well.

## [Package vs Library](packagevslibrary)

To make contributing as smooth as possible and treeshaking as flexible as possible, each package is built individually to the dist folder. The entire library is then published as a single package to npm. This way, you don't have to rebuild the entire library when a single package is updated and you still cherry pick what is and isn't needed in your app.

You can build a single package while developing:

```bash
ng build my-new-package
```

Or the entire library:

```bash
npm run build
```

You can run tests on a single package:

```bash
ng test my-new-package
```

Or on the entire library:

```bash
npm test
```

You can import a single package in your app by name:

```typescript
import { FlyoutModule } from '@acpaas-ui/ngx-components/flyout';
```

## [Dependencies](dependencies)

If you have a dependency between 2 packages, you can use the same import paths as you would in your app:

```typescript
import { FlyoutModule } from '@acpaas-ui/ngx-components/flyout';
```

Typescript will resolve all `acpaas-ui` paths to the `dist` folder. This does imply however, that you should build the dependencies before building the package depending on them.

**An example:**

The `leaflet` package has a depenency on the `flyout` package, to show off some fancy dropdown menus.

This means:

* you can import assets from the `flyout` package like you would in your app
* the `leaflet` package cannot be built before the `flyout` package is built

### Building

When building the entire library, we need to make sure packages are built in the correct order. In our example, the `flyout` package needs to be built before the `leaflet` package.

When using the `ng build` command, the build will most likely fail, since packages are handled by alphabetical order and dependencies might not yet exist.

To ensure dependencies are built in the correct order, you can specify dependencies in the `package.json` of your package:

```json
{
    "name": "leaflet",
    ...
    "acpaas-ui": {
        "dependencies": [
            "flyout"
        ]
    }
}
```

An using the `npm run build` command, dependencies will be resolved properly: the `flyout` package will always be built before the `leaflet` package, regardless the alphabetical order.

## [Styleguide](styleguide)

In each package, an `examples` folder can be added. This folder should contain an Angular module, exposing one or more routes with pages containing examples displaying the capabilities of the package.

These examples are gather in the styleguide, which can be run with:

```bash
npm run styleguide
```

Open your browser on `://localhost:4200` to see the examples.

### Updating the styleguide

To update the examples, i.e. find all examples modules and add them to the styleguide, run:

```bash
npm run examples
```

### Styleguide routes

Inside the styleguide, you can find a file called `examples.routes.ts`. This file is autogenerated and consequently overwritten each time the `examples` command is run. You should not edit this file.